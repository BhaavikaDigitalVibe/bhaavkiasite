import{a as x}from"/build/_shared/chunk-C3DIUGGU.js";import{a as q}from"/build/_shared/chunk-SJIB4VAI.js";import{B as j,C as F,M as U,N as X,O as Y,f as E,h as G,m as T,n as W,p as A,v as B,w as H,y as I,z as V}from"/build/_shared/chunk-GX6LHZ7T.js";import{a as D}from"/build/_shared/chunk-LE7JPKRK.js";import{d as R}from"/build/_shared/chunk-YFP2YQSZ.js";import{c as C}from"/build/_shared/chunk-HPPG3BMY.js";import{a as P}from"/build/_shared/chunk-DCJLI3GM.js";import{a as v,j as S,k as b}from"/build/_shared/chunk-CG2D626R.js";import{a as K,b as z}from"/build/_shared/chunk-GDLBX7ER.js";import{c as g}from"/build/_shared/chunk-Q3IECNXJ.js";var r=g(K(),1);var N={canvas:"_17BOs"};var y=g(z(),1),O={stiffness:30,damping:20,mass:2},Q=x("./app/routes/home/displacement-sphere-fragment.glsl"),Z=x("./app/routes/home/displacement-sphere-vertex.glsl"),me=_=>{let{theme:d}=R(),k=(0,r.useRef)(Date.now()),l=(0,r.useRef)(),J=(0,r.useRef)(),i=(0,r.useRef)(),c=(0,r.useRef)(),s=(0,r.useRef)(),h=(0,r.useRef)(),u=(0,r.useRef)(),w=(0,r.useRef)(),L=(0,r.useRef)(),n=(0,r.useRef)(),a=b(),m=P(l),M=D(),f=S(0,O),p=S(0,O);return(0,r.useEffect)(()=>{let{innerWidth:e,innerHeight:t}=window;return J.current=new G(.8,.5),i.current=new B({canvas:l.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),i.current.setSize(e,t),i.current.setPixelRatio(1),i.current.outputColorSpace=E,c.current=new A(54,e/t,.1,100),c.current.position.z=52,s.current=new H,w.current=new V,w.current.onBeforeCompile=o=>{u.current=W.merge([o.uniforms,{time:{type:"f",value:0}}]),o.uniforms=u.current,o.vertexShader=Z,o.fragmentShader=Q},(0,r.startTransition)(()=>{L.current=new I(32,128,128),n.current=new T(L.current,w.current),n.current.position.z=0,n.current.modifier=Math.random(),s.current.add(n.current)}),()=>{U(s.current),X(i.current)}},[]),(0,r.useEffect)(()=>{let e=new j(16777215,d==="light"?1.8:2),t=new F(16777215,d==="light"?2.7:.4);return e.position.z=200,e.position.x=100,e.position.y=100,h.current=[e,t],h.current.forEach(o=>s.current.add(o)),()=>{Y(h.current)}},[d]),(0,r.useEffect)(()=>{let{width:e,height:t}=M,o=t+t*.3;i.current.setSize(e,o),c.current.aspect=e/o,c.current.updateProjectionMatrix(),a&&i.current.render(s.current,c.current),e<=v.mobile?(n.current.position.x=14,n.current.position.y=10):e<=v.tablet?(n.current.position.x=18,n.current.position.y=14):(n.current.position.x=22,n.current.position.y=16)},[a,M]),(0,r.useEffect)(()=>{let e=q(t=>{let o={x:t.clientX/window.innerWidth,y:t.clientY/window.innerHeight};f.set(o.y/2),p.set(o.x/2)},100);return!a&&m&&window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}},[m,a,f,p]),(0,r.useEffect)(()=>{let e,t=()=>{e=requestAnimationFrame(t),u.current!==void 0&&(u.current.time.value=5e-5*(Date.now()-k.current)),n.current.rotation.z+=.001,n.current.rotation.x=f.get(),n.current.rotation.y=p.get(),i.current.render(s.current,c.current)};return!a&&m?t():i.current.render(s.current,c.current),()=>{cancelAnimationFrame(e)}},[m,a,f,p]),(0,y.jsx)(C,{in:!0,timeout:3e3,nodeRef:l,children:({visible:e,nodeRef:t})=>(0,y.jsx)("canvas",{"aria-hidden":!0,className:N.canvas,"data-visible":e,ref:t,..._})})};export{me as DisplacementSphere};
